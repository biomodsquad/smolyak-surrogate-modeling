import numpy

from .benchmark import BenchmarkFunction

class growth(BenchmarkFunction):
    @property
    def domain(self):
        return [[-8.53967303, 10.314294273], [-9.5571937886, 9.39852559026], [-9.836246351, 9.1473782841]]

    @property
    def global_minimum(self):
        return 1.0040405841
    
    @property
    def global_minimum_location(self):
        return [1.46032697, 0.4428062114, 0.163753649]

    def _function(self,x):
        v = numpy.zeros(list(x.shape[:-1]) + [3])
        v[...,0] = 2.0794415416798357 * x[...,2]
        v[...,1] = x[...,1] + v[...,0]
        v[...,0] = 2.079442 * v[...,1]
        v[...,1] = numpy.exp(v[...,0])
        v[...,0] = x[...,0] * v[...,1]
        v[...,1] = -8. + v[...,0]
        v[...,0] = v[...,1] * v[...,1]
        v[...,1] = 2.1972245773362196 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.197225 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -8.4305 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.302585092994046 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.302585 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -9.5294 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.3978952727983707 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.397895 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -10.4627 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.4849066497880004 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.484907 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -12. + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.5649493574615367 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.564949 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -13.0205 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.6390573296152584 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.639057 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -14.5949 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.70805020110221 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.70805 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -16.1078 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.772588722239781 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.772589 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -18.0596 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.8903717578961645 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.890372 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -20.4569 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 2.995732273553991 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.995732 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -24.25 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        v[...,1] = 3.2188758248682006 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 3.218876 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -32.9863 + v[...,1]
        v[...,1] = v[...,2] * v[...,2]
        v[...,0] += v[...,1]
        return v[...,0]

class growthls(BenchmarkFunction):
    @property
    def domain(self):
        return [[-8.53967303, 10.314294273], [-9.5571937886, 9.39852559026], [-9.836246351, 9.1473782841]]

    @property
    def global_minimum(self):
        return 1.0040405841
    
    @property
    def global_minimum_location(self):
        return [1.46032697, 0.4428062114, 0.163753649]

    def _function(self,x):
        v = numpy.zeros(list(x.shape[:-1]) + [4])
        v[...,0] = 2.079441542 * x[...,2]
        v[...,1] = x[...,1] + v[...,0]
        v[...,0] = 2.079442 * v[...,1]
        v[...,1] = numpy.exp(v[...,0])
        v[...,0] = x[...,0] * v[...,1]
        v[...,1] = -8. + v[...,0]
        v[...,0] = 2.079441542 * x[...,2]
        v[...,2] = x[...,1] + v[...,0]
        v[...,0] = 2.079442 * v[...,2]
        v[...,2] = numpy.exp(v[...,0])
        v[...,0] = x[...,0] * v[...,2]
        v[...,2] = -8. + v[...,0]
        v[...,0] = v[...,1] * v[...,2]
        v[...,1] = 2.19722457733622 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.19722457733622 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -8.4305 + v[...,1]
        v[...,1] = 2.19722457733622 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.19722457733622 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -8.4305 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.302585093 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.302585 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -9.5294 + v[...,1]
        v[...,1] = 2.302585093 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.302585 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -9.5294 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.397895273 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.397895 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -10.4627 + v[...,1]
        v[...,1] = 2.397895273 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.397895 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -10.4627 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.48490665 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.484907 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -12. + v[...,1]
        v[...,1] = 2.48490665 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.484907 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -12. + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.564949357 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.564949 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -13.0205 + v[...,1]
        v[...,1] = 2.564949357 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.564949 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -13.0205 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.63905733 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.639057 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -14.5949 + v[...,1]
        v[...,1] = 2.63905733 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.639057 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -14.5949 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.708050201 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.70805 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -16.1078 + v[...,1]
        v[...,1] = 2.708050201 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.70805 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -16.1078 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.77258872223978 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.772589 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -18.0596 + v[...,1]
        v[...,1] = 2.77258872223978 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.772589 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -18.0596 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.890371758 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.890372 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -20.4569 + v[...,1]
        v[...,1] = 2.890371758 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.890372 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -20.4569 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 2.99573227355399 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 2.995732 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -24.25 + v[...,1]
        v[...,1] = 2.99573227355399 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 2.995732 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -24.25 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        v[...,1] = 3.218875825 * x[...,2]
        v[...,2] = x[...,1] + v[...,1]
        v[...,1] = 3.218876 * v[...,2]
        v[...,2] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,2]
        v[...,2] = -32.9863 + v[...,1]
        v[...,1] = 3.218875825 * x[...,2]
        v[...,3] = x[...,1] + v[...,1]
        v[...,1] = 3.218876 * v[...,3]
        v[...,3] = numpy.exp(v[...,1])
        v[...,1] = x[...,0] * v[...,3]
        v[...,3] = -32.9863 + v[...,1]
        v[...,1] = v[...,2] * v[...,3]
        v[...,0] += v[...,1]
        return v[...,0]
